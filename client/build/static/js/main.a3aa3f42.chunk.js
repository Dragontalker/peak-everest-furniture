(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{196:function(e,t,c){},197:function(e,t,c){},198:function(e,t,c){},331:function(e,t,c){},332:function(e,t,c){},333:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c.n(n),a=c(66),r=c.n(a),i=c(23),o=c(20),l=c(9),d=c.n(l),u=c(16),j=c(8),b=c(32),h=c(1),p={winX:window.innerWidth,winY:window.innerHeight,loggedIn:!1,username:"[User]",openShopCart:!1,openNavExt:!1},m=function(e,t){switch(t.type){case"resize":return Object(b.a)(Object(b.a)({},e),{},{winX:window.innerWidth,winY:window.innerHeight});case"logout":return Object(b.a)(Object(b.a)({},e),{},{loggedIn:!1});case"login":return Object(b.a)(Object(b.a)({},e),{},{loggedIn:!0});case"toggle-shop-cart":return Object(b.a)(Object(b.a)({},e),{},{openShopCart:!e.openShopCart});case"toggle-nav-ext":return Object(b.a)(Object(b.a)({},e),{},{openNavExt:!e.openNavExt});default:throw new Error("Invalid action type: ".concat(t.type))}},O=Object(n.createContext)(),x=function(e){var t=Object(n.useReducer)(m,p),c=Object(j.a)(t,2),s=c[0],a=c[1];function r(){return(r=Object(u.a)(d.a.mark((function e(){var t,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("sessionId"),e.next=3,fetch("/api/users/".concat(t)).then((function(e){return e.json()}));case 3:(c=e.sent).error?(console.log(c.error),localStorage.removeItem("sessionId")):a({type:"login"});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){r.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){function e(){a({type:"resize"})}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),Object(h.jsx)(O.Provider,Object(b.a)({value:[s,a]},e))},f=function(){return Object(n.useContext)(O)};var v=function(){var e=f(),t=Object(j.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(!1),r=Object(j.a)(a,2),o=r[0],l=r[1];function b(){return(b=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("sessionId"))){e.next=6;break}return e.next=4,fetch("/api/users/".concat(t)).then((function(e){return e.json()}));case 4:e.sent.isAdmin&&l(!0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.openShopCart&&s({type:"toggle-shop-cart"}),t=localStorage.getItem("sessionId"),localStorage.removeItem("sessionId"),e.next=5,fetch("/api/logout/".concat(t));case 5:s({type:"logout"});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){s({type:"toggle-shop-cart"})}function x(){s({type:"toggle-nav-ext"})}return Object(n.useEffect)((function(){!function(){b.apply(this,arguments)}()}),[]),Object(h.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark main-nav",children:Object(h.jsxs)("div",{className:"container-fluid",children:[Object(h.jsx)("span",{className:"navbar-brand",children:"Peak Everest Furnitures"}),c.winX>800&&c.loggedIn?Object(h.jsxs)("div",{className:"navbar-nav",children:[Object(h.jsx)(i.c,{exact:!0,to:"/",className:"nav-link",activeClassName:"disabled",children:"Home"}),o?Object(h.jsx)(i.c,{to:"/admin",className:"nav-link",activeClassName:"disabled",children:"Administration"}):Object(h.jsx)("button",{className:"btn nav-link",onClick:O,children:"Shopping Cart"}),Object(h.jsx)("button",{className:"btn nav-link",onClick:p,children:"Logout"})]}):c.winX>800?Object(h.jsxs)("div",{className:"navbar-nav",children:[Object(h.jsx)(i.c,{exact:!0,to:"/",className:"nav-link",activeClassName:"disabled",children:"Home"}),Object(h.jsx)(i.c,{to:"/register",className:"nav-link",activeClassName:"disabled",children:"Register"}),Object(h.jsx)(i.c,{to:"/login",className:"nav-link",activeClassName:"disabled",children:"Login"})]}):Object(h.jsx)("div",{className:"navbar-nav",children:Object(h.jsx)("button",{className:"btn navbar-toggler-icon",onClick:x})})]})})};var g=function(){var e=Object(n.useRef)(null),t=f(),c=Object(j.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)(!1),o=Object(j.a)(r,2),l=o[0],b=o[1],p=Object(n.useState)(!1),m=Object(j.a)(p,2),O=m[0],x=m[1];function v(){return(v=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("sessionId"))){e.next=6;break}return e.next=4,fetch("/api/users/".concat(t)).then((function(e){return e.json()}));case 4:e.sent.isAdmin&&x(!0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){a({type:"toggle-nav-ext"})}function N(){a({type:"toggle-shop-cart"}),a({type:"toggle-nav-ext"})}function y(){a({type:"logout"}),a({type:"toggle-nav-ext"}),s.openShopCart&&a({type:"toggle-shop-cart"})}return Object(n.useEffect)((function(){s.openNavExt?b(!0):l&&!s.openNavExt&&(e.current.classList.add("nav-ext-close"),setTimeout((function(){e.current.classList.remove("nav-ext-close"),b(!1)}),290))}),[s.openNavExt]),Object(n.useEffect)((function(){!function(){v.apply(this,arguments)}()}),[]),l&&s.winX<800?Object(h.jsx)("div",{className:"navbar navbar-dark bg-dark nav-extend",ref:e,children:Object(h.jsx)("div",{className:"container-fluid",children:s.loggedIn?Object(h.jsxs)("div",{className:"navbar-nav col",children:[Object(h.jsx)(i.c,{exact:!0,to:"/",className:"nav-link",activeClassName:"disabled",onClick:g,children:"Home"}),O?Object(h.jsx)(i.c,{to:"/admin",className:"nav-link",activeClassName:"disabled",children:"Administration"}):Object(h.jsx)("button",{className:"btn nav-link",onClick:N,style:{textAlign:"right"},children:"Shopping Cart"}),Object(h.jsx)("button",{className:"btn nav-link",onClick:y,style:{textAlign:"right"},children:"Logout"})]}):Object(h.jsxs)("div",{className:"navbar-nav col",children:[Object(h.jsx)(i.c,{exact:!0,to:"/",className:"nav-link",activeClassName:"disabled",onClick:g,children:"Home"}),Object(h.jsx)(i.c,{to:"/register",className:"nav-link",activeClassName:"disabled",onClick:g,children:"Register"}),Object(h.jsx)(i.c,{to:"/login",className:"nav-link",activeClassName:"disabled",onClick:g,children:"Login"})]})})}):null};var N=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(!1),c=Object(j.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)([]),o=Object(j.a)(r,2),l=o[0],b=o[1],p=f(),m=Object(j.a)(p,2),O=m[0],x=m[1];function v(){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(d.a.mark((function e(){var t,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("sessionId"),e.next=3,fetch("/api/users/".concat(t)).then((function(e){return e.json()}));case 3:c=e.sent,b(c.cart);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(u.a)(d.a.mark((function e(){var t,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("checkout all shopping cart items"),t=localStorage.getItem("sessionId"),e.next=4,fetch("/api/users/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"CHECKOUT"})});case 4:c=e.sent,v(),console.log(c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(u.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=localStorage.getItem("sessionId"),e.next=3,fetch("/api/users/".concat(c),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({cartId:t,status:"CANCEL"})});case 3:v();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){O.openShopCart?(v(),a(!0)):s&&!O.openShopCart&&(e.current.classList.add("shop-cart-close"),setTimeout((function(){e.current.classList.remove("shop-cart-close"),a(!1)}),290))}),[O.openShopCart]),s?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"shop-cart-body",ref:e,children:[Object(h.jsx)("h4",{className:"mt-2 mb-3",children:"Shopping Cart"}),Object(h.jsxs)("ul",{className:"list-group",children:[l.length?"":Object(h.jsx)("span",{className:"text-muted",children:"No items in your cart "}),l.map((function(e){return Object(h.jsxs)("li",{className:"list-group-item d-flex shop-cart-item",children:[Object(h.jsxs)("div",{className:"flex-fill ms-2 mt-1",style:{transform:"rotate(0)"},children:[Object(h.jsx)("p",{className:"card-text",children:e.heading.length<23?e.heading:e.heading.slice(0,22)+"..."}),Object(h.jsx)(i.b,{className:"stretched-link",to:"/product/"+e.productId,onClick:function(){return x({type:"toggle-shop-cart"})},children:"Go to product page"})]}),Object(h.jsxs)("div",{className:"mt-auto",children:[Object(h.jsxs)("p",{className:"text-end me-2",children:["$",e.price]}),Object(h.jsx)("button",{className:"btn btn-sm link-danger",onClick:function(){return function(e){return y.apply(this,arguments)}(e._id)},children:"Remove"})]})]},e._id)}))]}),Object(h.jsxs)("div",{className:"checkout-container",children:[Object(h.jsxs)("p",{children:["Total: $",function(){var e=0;return l.forEach((function(t){e+=t.price})),e.toFixed(2)}()," "]}),Object(h.jsx)("button",{className:"btn btn-light",onClick:function(){return N.apply(this,arguments)},children:"Checkout"})]})]}),Object(h.jsx)("div",{className:"back-cover",onClick:function(){return x({type:"toggle-shop-cart"})}})]}):null},y=c(157);c(195),c(196);var w=function(){var e=Object(n.useState)([]),t=Object(j.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)([]),r=Object(j.a)(a,2),o=r[0],l=r[1];function b(){return(b=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s([{heading:"Banner #1",desc:"Extra info 1",img:"https://www.hermanmiller.com/content/dam/hmicom/page_assets/products/categories/gaming/it_cmp_gaming_motia_gaming_table.jpg"},{heading:"Banner #2",desc:"Extra info 2",img:"https://i.gyazo.com/cc114cc01d65fa4820be8652151b61b0.png"},{heading:"Banner #3",desc:"Extra info 3",img:"https://i.gyazo.com/97b764beb0a96af871fec590c7e217c3.png"}]),e.next=4,fetch("/api/products").then((function(e){return e.json()}));case 4:t=e.sent,l(t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){b.apply(this,arguments)}()}),[]),Object(h.jsxs)("div",{className:"shop-page mt-3",children:[Object(h.jsx)(y.Carousel,{autoPlay:!0,centerMode:!0,centerSlidePercentage:100,infiniteLoop:!0,transitionTime:800,interval:3e3,showArrows:!1,showThumbs:!1,showStatus:!1,children:c.map((function(e,t){return Object(h.jsxs)("div",{className:"slide-item",children:[Object(h.jsxs)("div",{className:"desc",children:[Object(h.jsx)("h3",{children:e.heading}),Object(h.jsx)("p",{children:e.desc})]}),Object(h.jsx)("img",{src:e.img,alt:"product"})]},t)}))}),Object(h.jsx)("hr",{}),Object(h.jsxs)("div",{className:"all-products-list mb-3",children:[Object(h.jsx)("h1",{children:"All Products"}),Object(h.jsx)("div",{className:"row",children:o&&o.map((function(e,t){return Object(h.jsx)("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-2",children:Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"shop-card-img",children:Object(h.jsx)("img",{src:e.image[0],className:"card-img-top img-fluid",alt:e.heading})}),Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title",children:e.heading}),Object(h.jsxs)("p",{className:"card-text",children:["$",e.price]}),Object(h.jsx)(i.b,{to:"/product/"+e._id,className:"stretched-link",children:"See Product"})]})]})},t)}))})]})]})};var k=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(""),r=Object(j.a)(a,2),i=r[0],o=r[1],l=Object(n.useState)(""),b=Object(j.a)(l,2),p=b[0],m=b[1],O=Object(n.useRef)(null),x=Object(n.useRef)(null),f=Object(n.useRef)(null),v=Object(n.useRef)(null);function g(){var e=x.current.value;return!!new RegExp(".+@.+\\..+").test(e)||(x.current.classList.add("is-invalid"),s("Invalid email format"),!1)}function N(){var e=[f.current.value,v.current.value],t=e[0],c=e[1];return t.length<1?(f.current.classList.add("is-invalid"),v.current.classList.add("is-invalid"),o("Please enter a password"),!1):t===c||(f.current.classList.add("is-invalid"),v.current.classList.add("is-invalid"),o("Passwords do not match"),!1)}function y(){return(y=Object(u.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),console.log("Attempting to sign up"),x.current.classList.remove("is-invalid"),f.current.classList.remove("is-invalid"),v.current.classList.remove("is-invalid"),s(""),o(""),m(""),g()){e.next=10;break}return e.abrupt("return");case 10:if(N()){e.next=12;break}return e.abrupt("return");case 12:return c={name:O.current.value,email:x.current.value,password:f.current.value},e.next=15,fetch("/api/users",{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 15:e.sent.emailAlreadyExists?(x.current.classList.add("is-invalid"),s("This account already exists")):m("Registration successful.");case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)("div",{className:"card mt-3 login-body",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title mb-3",children:"Sign Up"}),Object(h.jsxs)("form",{onSubmit:function(e){return function(e){return y.apply(this,arguments)}(e)},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"displayNameInput",className:"form-label",children:"Display name"}),Object(h.jsx)("input",{name:"name",type:"text",className:"form-control",id:"displayNameInput",placeholder:"name",ref:O})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"emailInput",className:"form-label",children:"Email"}),Object(h.jsx)("input",{name:"email",type:"email",className:"form-control",id:"emailInput",placeholder:"name@example.com",ref:x}),c.length>0?Object(h.jsx)("span",{className:"invalid-feedback",children:c}):""]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"passwordInput",className:"form-check-label",children:"Password"}),Object(h.jsx)("input",{name:"password",type:"password",className:"form-control",id:"passwordInput",placeholder:"********",ref:f})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"passwordReinput",className:"form-check-label",children:"Confirm Password"}),Object(h.jsx)("input",{name:"repassword",type:"password",className:"form-control",id:"passwordReinput",placeholder:"********",ref:v}),i.length>0?Object(h.jsx)("span",{className:"invalid-feedback",children:i}):""]}),Object(h.jsxs)("div",{className:"text-center mb-3",children:[p.length>0?Object(h.jsx)("p",{className:"d-block valid-feedback",children:p}):"",Object(h.jsx)("button",{className:"btn btn-dark",children:"Register"})]})]})]})})};c(197);var S=function(){var e=f(),t=Object(j.a)(e,2)[1],c=Object(n.useState)(""),s=Object(j.a)(c,2),a=s[0],r=s[1],i=Object(n.useRef)(null),o=Object(n.useRef)(null);function l(){return(l=Object(u.a)(d.a.mark((function e(c){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),r(""),console.log("trying to login"),e.next=5,fetch("/api/login",{method:"POST",body:JSON.stringify({email:i.current.value,password:o.current.value}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 5:(n=e.sent).error?r(n.error):(console.log(n),localStorage.setItem("sessionId",n.sessionId),t({type:"login"}),window.location.replace("/"));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)("div",{className:"card mt-3 login-body",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title mb-3",children:"Login"}),Object(h.jsxs)("form",{onSubmit:function(e){return function(e){return l.apply(this,arguments)}(e)},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"emailInput",className:"form-label",children:"Email address"}),Object(h.jsx)("input",{type:"email",className:"form-control",id:"emailInput",ref:i,placeholder:"name@example.com"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"passwordInput",className:"form-label",children:"Password"}),Object(h.jsx)("input",{type:"password",className:"form-control",ref:o,id:"passwordInput",placeholder:"********"}),a.length>0?Object(h.jsxs)("span",{className:"login-err",children:["Error: ",a]}):""]}),Object(h.jsx)("div",{className:"text-center mb-3",children:Object(h.jsx)("button",{className:"btn btn-dark",children:"Login"})})]}),Object(h.jsx)("div",{className:"text-center mb-3",children:Object(h.jsx)("button",{className:"btn btn-secondary",onClick:function(){window.location.replace("/register")},children:"Create a new account"})})]})})};c(198);var C=function(){var e=Object(o.f)().id,t=Object(n.useState)({}),c=Object(j.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)([]),i=Object(j.a)(r,2),l=i[0],b=i[1];function p(){return(p=Object(u.a)(d.a.mark((function t(){var c,n,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/products/".concat(e)).then((function(e){return e.json()}));case 2:return c=t.sent,a(c),t.next=6,fetch("/api/products").then((function(e){return e.json()}));case 6:n=t.sent,s=m(n),b(s);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(e){for(var t,c,n=e.slice(0),s=e.length;s--;)t=n[c=Math.floor((s+1)*Math.random())],n[c]=n[s],n[s]=t;return n.slice(0,4)}function O(){return(O=Object(u.a)(d.a.mark((function t(){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(c=localStorage.getItem("sessionId"))){t.next=6;break}return t.next=4,fetch("/api/users/".concat(c),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,heading:s.heading,price:s.price,status:"BUYING"})});case 4:t.next=7;break;case 6:window.location.replace("/login");case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:"card mb-3 card-background",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col-md-6",children:s.image&&s.image.map((function(e){return Object(h.jsx)("div",{className:"col-lg-6 col-md-12 col-sm-12 outline d-flex align-items-stretch margin",children:Object(h.jsx)("div",{className:"card",children:Object(h.jsx)("img",{src:e,alt:s.name})})})}))}),Object(h.jsx)("div",{className:"col-md-6",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h1",{className:"card-title",children:s.heading}),Object(h.jsxs)("h5",{children:["$",s.price]}),Object(h.jsx)("p",{className:"card-text",children:"Description:"}),Object(h.jsx)("p",{className:"card-text",children:s.description}),Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("h5",{children:"View Other Products"}),l&&l.map((function(e,t){return Object(h.jsx)("div",{className:"col-3 col-sm-3 col-md-3 col-lg-3",children:Object(h.jsx)("div",{className:"card cardBackground",children:Object(h.jsx)("button",{onClick:function(){return function(e){window.location.replace("/product/"+e)}(e._id)},className:"btn stretched-link",children:Object(h.jsx)("img",{src:e.image[0],className:"card-img-top img-fluid",alt:e.heading})})})},t)}))]}),Object(h.jsx)("button",{className:"btn btn-dark product-button",onClick:function(){return O.apply(this,arguments)},children:"Add to Cart"})]})})]})}),Object(h.jsx)("hr",{}),Object(h.jsx)("h1",{children:"Ratings and Reviews"}),s.reviews&&s.reviews.map((function(e){return Object(h.jsx)("div",{children:Object(h.jsxs)("div",{className:"card border-light mb-3",children:[Object(h.jsx)("div",{className:"card-header",children:e.name}),Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsxs)("h5",{className:"card-title",children:["Rating: ",e.rating,"/5"]}),Object(h.jsx)("p",{className:"card-text",children:e.review})]})]})})}))]})};var I=function(){return Object(h.jsxs)("div",{className:"mt-3",style:{textAlign:"center"},children:[Object(h.jsx)("h2",{className:"mx-auto",children:"Access Denied"}),Object(h.jsx)("p",{children:"You do not have access to this page. Please login with an administrative account."})]})};var P=function(e){var t=Object(n.useState)([]),c=Object(j.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)(0),i=Object(j.a)(r,2),o=i[0],l=i[1];return Object(n.useEffect)((function(){var t=e.products,c=0;t.forEach((function(t){t.unitsSold=0,t.profit=0,e.trans.forEach((function(e){t._id!==e.productId||"BOUGHT"!==e.status&&"SOLD"!==e.status||(t.unitsSold+=1)})),t.profit=t.unitsSold*t.price,c+=t.profit})),a(t),l(c.toFixed(2))}),[e]),Object(h.jsxs)("div",{className:"admin-product-list table-responsive",children:[Object(h.jsxs)("div",{className:"header",children:[Object(h.jsx)("h5",{children:"Product List"}),Object(h.jsx)("button",{className:"btn btn-sm btn-dark",onClick:function(){return e.setPopupProduct({})},children:"Add New Product"})]}),Object(h.jsxs)("table",{className:"table table-sm",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"ID"}),Object(h.jsx)("th",{scope:"col",children:"Name"}),Object(h.jsx)("th",{scope:"col",children:"Price"}),Object(h.jsx)("th",{scope:"col",children:"Units Sold"}),Object(h.jsx)("th",{scope:"col",children:"Profit"}),Object(h.jsx)("th",{scope:"col"})]})}),Object(h.jsx)("tbody",{children:s.map((function(t,c){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:t._id}),Object(h.jsx)("th",{children:t.heading}),Object(h.jsxs)("td",{children:["$",t.price]}),Object(h.jsx)("td",{children:t.unitsSold}),Object(h.jsxs)("td",{children:["$",t.profit]}),Object(h.jsx)("td",{className:"text-end",children:Object(h.jsx)("button",{className:"btn btn-sm btn-outline-dark",onClick:function(){return e.setPopupProduct(t)},children:"Edit"})})]},c)}))}),Object(h.jsx)("tfoot",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{}),Object(h.jsx)("td",{}),Object(h.jsx)("td",{}),Object(h.jsx)("th",{scope:"row",children:"Total:"}),Object(h.jsxs)("td",{children:["$",o]}),Object(h.jsx)("td",{})]})})]})]})};var E=function(e){var t=Object(n.useState)([]),c=Object(j.a)(t,2),s=c[0],a=c[1];function r(){return(r=Object(u.a)(d.a.mark((function t(c){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("set transaction with id "+c+" to status SOLD"),t.next=3,fetch("/api/transactions/".concat(c),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"SOLD"})});case 3:n=t.sent,console.log(n),e.refreshData();case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var t=e.trans.filter((function(e){return"BOUGHT"===e.status}));a(t)}),[e]),Object(h.jsxs)("div",{className:"admin-trans-list table-responsive",children:[Object(h.jsx)("h5",{children:"Ongoing Transactions"}),Object(h.jsxs)("table",{className:"table table-sm",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"Transaction ID"}),Object(h.jsx)("th",{scope:"col",children:"User ID"}),Object(h.jsx)("th",{scope:"col",children:"Product Name"}),Object(h.jsx)("th",{scope:"col",children:"Time of sale"}),Object(h.jsx)("th",{scope:"col"})]})}),Object(h.jsx)("tbody",{children:s.map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e._id}),Object(h.jsx)("td",{children:e.userId}),Object(h.jsx)("th",{children:e.productName}),Object(h.jsxs)("td",{children:[new Date(e.updatedAt).toLocaleDateString()," ",new Date(e.updatedAt).toLocaleTimeString()]}),Object(h.jsx)("td",{className:"text-end",children:Object(h.jsx)("button",{className:"btn btn-sm btn-outline-dark",onClick:function(){return function(e){return r.apply(this,arguments)}(e._id)},children:"Delivery Sent"})})]},e._id)}))})]})]})},T=c(335),L=c(172),D=c(173),A=c(75),R=c(72),_=c(176);var U=function(e){var t=Object(n.useState)([]),c=Object(j.a)(t,2),s=c[0],a=c[1];return Object(n.useEffect)((function(){var t=[];e.products.forEach((function(e){t.push({productid:e._id,bought:0,sold:0,cancelled:0})})),e.trans.forEach((function(e){t.forEach((function(t){t.productid===e.productId&&"BOUGHT"===e.status?t.bought++:t.productid===e.productId&&"SOLD"===e.status?t.sold++:t.productid===e.productId&&"CANCELLED"===e.status&&t.cancelled++}))})),a(t)}),[e]),Object(h.jsxs)("div",{className:"admin-charts",children:[Object(h.jsx)("h5",{className:"card-text",children:"Sales Info"}),Object(h.jsxs)(T.a,{width:800,height:300,data:s,children:[Object(h.jsx)(L.a,{dataKey:"productid",tick:!1}),Object(h.jsx)(D.a,{}),Object(h.jsx)(A.a,{}),Object(h.jsx)(R.a,{}),Object(h.jsx)(_.a,{dataKey:"bought",fill:"#8884d8"}),Object(h.jsx)(_.a,{dataKey:"sold",fill:"#82ca9d"}),Object(h.jsx)(_.a,{dataKey:"cancelled",fill:"#ff2525"})]})]})},F=c(175);var H=function(e){var t=Object(n.useState)(e.product.heading),c=Object(j.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)(e.product.price),i=Object(j.a)(r,2),o=i[0],l=i[1],b=Object(n.useState)(e.product.description),p=Object(j.a)(b,2),m=p[0],O=p[1],x=Object(n.useState)(e.product.image||[]),f=Object(j.a)(x,2),v=f[0],g=f[1];function N(){return(N=Object(u.a)(d.a.mark((function t(){var c,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Adding this product"),c={heading:s,price:o,description:m,images:v},t.next=4,fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json",sessionid:localStorage.getItem("sessionId")},body:JSON.stringify(c)}).then((function(e){return e.json()}));case 4:n=t.sent,console.log(n),e.refreshData(),e.setPopupProduct(null);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(){return(y=Object(u.a)(d.a.mark((function t(){var c,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Updating product",e.product._id),c={heading:s,price:o,description:m,images:v},t.next=4,fetch("/api/products/".concat(e.product._id),{method:"PUT",headers:{"Content-Type":"application/json",sessionid:localStorage.getItem("sessionId")},body:JSON.stringify(c)}).then((function(e){return e.json()}));case 4:n=t.sent,console.log(n),e.refreshData(),e.setPopupProduct(null);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(){return(w=Object(u.a)(d.a.mark((function t(){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Deleting product",e.product._id),t.next=3,fetch("/api/products/".concat(e.product._id),{method:"DELETE",headers:{sessionid:localStorage.getItem("sessionId")}}).then((function(e){return e.json()}));case 3:c=t.sent,console.log(c),e.refreshData(),e.setPopupProduct(null);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(e,t){var c=v;c[t]=e.target.value,g(Object(F.a)(c))}return Object(n.useEffect)((function(){window.scrollTo(0,80)}),[e]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"product-info-popup",children:Object(h.jsx)("div",{className:"card",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title",children:"Product Information"}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col-8 my-auto",children:[Object(h.jsx)("label",{className:"form-label",children:"Product Name"}),Object(h.jsx)("input",{type:"text",value:s,onChange:function(e){return a(e.target.value)},className:"form-control"})]}),Object(h.jsxs)("div",{className:"col-4",children:[Object(h.jsx)("label",{className:"form-label",children:"Price"}),Object(h.jsx)("input",{type:"number",value:o,onChange:function(e){return l(e.target.value)},className:"form-control"})]}),Object(h.jsxs)("div",{className:"col-12  mb-2",children:[Object(h.jsx)("label",{className:"form-label",children:"Description"}),Object(h.jsx)("textarea",{value:m,onChange:function(e){return O(e.target.value)},rows:4,className:"form-control"})]}),Object(h.jsxs)("div",{className:"col-12 mb-2",children:[Object(h.jsx)("label",{className:"form-label",children:"Pictures (Requires HTTP URLs)"}),Object(h.jsx)("input",{type:"text",value:v[0],onChange:function(e){return k(e,0)},className:"form-control mb-2"}),Object(h.jsx)("input",{type:"text",value:v[1],onChange:function(e){return k(e,1)},className:"form-control mb-2"}),Object(h.jsx)("input",{type:"text",value:v[2],onChange:function(e){return k(e,2)},className:"form-control mb-2"}),Object(h.jsx)("input",{type:"text",value:v[3],onChange:function(e){return k(e,3)},className:"form-control mb-2"})]}),Object(h.jsx)("div",{className:"col-12 mb-2 mx-auto",children:e.product._id?Object(h.jsxs)("div",{className:"btn-group",children:[Object(h.jsx)("button",{className:"btn btn-dark",onClick:function(){return y.apply(this,arguments)},children:"Update Product"}),Object(h.jsx)("button",{className:"btn btn-danger",onClick:function(){return w.apply(this,arguments)},children:"Delete Product"})]}):Object(h.jsxs)("div",{className:"btn-group",children:[Object(h.jsx)("button",{className:"btn btn-dark",onClick:function(){return N.apply(this,arguments)},children:"Add Product"}),Object(h.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.setPopupProduct(null)},children:"Cancel"})]})})]})]})})}),Object(h.jsx)("div",{className:"product-info-backdrop",onClick:function(){return e.setPopupProduct(null)}})]})};c(331);var B=function(){var e=Object(n.useState)(!1),t=Object(j.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)([]),r=Object(j.a)(a,2),i=r[0],o=r[1],l=Object(n.useState)([]),b=Object(j.a)(l,2),p=b[0],m=b[1],O=Object(n.useState)(null),x=Object(j.a)(O,2),f=x[0],v=x[1];function g(){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(d.a.mark((function e(){var t,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/products").then((function(e){return e.json()}));case 2:return(t=e.sent).error?console.log(t.error):o(t),e.next=6,fetch("/api/transactions",{method:"GET",headers:{sessionId:localStorage.getItem("sessionId")}}).then((function(e){return e.json()}));case 6:(c=e.sent).error?console.log(c.error):m(c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("sessionId"),e.next=3,fetch("/api/users/".concat(t)).then((function(e){return e.json()}));case 3:e.sent.isAdmin?(console.log("Welcome admin"),s(!0),g()):console.log("Access denied");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),c?Object(h.jsxs)("div",{className:"admin-page card my-3",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)("h4",{children:"Welcome Back [Admin]"})}),Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)(U,{products:i,trans:p}),Object(h.jsx)("br",{}),Object(h.jsx)(P,{products:i,trans:p,setPopupProduct:v}),Object(h.jsx)(E,{products:i,trans:p,refreshData:g})]}),f?Object(h.jsx)(H,{product:f,setPopupProduct:v,refreshData:g}):""]}):Object(h.jsx)(I,{})};c(332);var J=function(){return Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(x,{children:Object(h.jsxs)(i.a,{children:[Object(h.jsx)(v,{}),Object(h.jsx)(g,{}),Object(h.jsx)("div",{className:"container-lg",children:Object(h.jsxs)(o.c,{children:[Object(h.jsx)(o.a,{exact:!0,path:"/",children:Object(h.jsx)(w,{})}),Object(h.jsx)(o.a,{path:"/register",children:Object(h.jsx)(k,{})}),Object(h.jsx)(o.a,{path:"/login",children:Object(h.jsx)(S,{})}),Object(h.jsx)(o.a,{path:"/product/:id",children:Object(h.jsx)(C,{})}),Object(h.jsx)(o.a,{path:"/admin",children:Object(h.jsx)(B,{})})]})}),Object(h.jsx)(N,{})]})})})};r.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(J,{})}),document.getElementById("root"))}},[[333,1,2]]]);
//# sourceMappingURL=main.a3aa3f42.chunk.js.map